---
import { ui } from "../i18n/ui.js";

const locale = Astro.locals.lang ?? 'en';
const { pathname } = Astro.url;
const user = Astro.locals.user;
---

<div class="navbar bg-base-100 border-b">
  <div class="flex-1">
    <a class="btn btn-ghost text-xl">TP 3 SVG BASSIL JAD</a>
  </div>
  
  <div class="flex-none mx-4">
    <form method="POST" action={Astro.url.pathname}>
      <select name="language" class="select select-sm" onchange="this.form.submit()">
        <option disabled selected="true">{ui[locale].nav.language}</option>
        <option value="en">English</option>
        <option value="fr">Fran√ßais</option>
      </select>
    </form>
  </div>
  
  <div class="flex-none">
    <div class="tabs tabs-boxed">
      <a href="/" class={`tab ${pathname === '/' ? 'tab-active' : ''}`}>
        {ui[locale].nav.home}
      </a>
      <a href="/generator" class={`tab ${pathname === '/generator' ? 'tab-active' : ''}`}>
        {ui[locale].nav.generator}
      </a>
      <a href="/gallery" class={`tab ${pathname === '/gallery' ? 'tab-active' : ''}`}>
        {ui[locale].nav.gallery}
      </a>
    </div>
  </div>

  {user ? (
    <form method="POST" action="/api/logout" class="m-0 p-0 ml-4">
      <button type="submit" class="btn btn-primary btn-sm gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
        </svg>
        {ui[locale].nav.logout}
      </button>
    </form>
  ) : (
    <a href="/login" class="btn btn-primary btn-sm ml-4 gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
      </svg>
      {ui[locale].nav.login}
    </a>
  )}
</div>
